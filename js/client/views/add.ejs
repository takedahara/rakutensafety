<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>避難所情報登録</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        * {
            box-sizing: border-box;
        }

        *:focus {
            outline: none;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background-color: #FFF;
            padding: 0;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .background {
            background-color: #BF0000;
            padding: 40px 20px;
            width: 100%;
            max-width: 530px;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .form-container {
            margin: 0 auto;
            width: 100%;
            max-width: 480px;
            background-color: #FFF;
            padding: 30px;
            border-radius: 40px;
            text-align: center;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            animation: fadeIn 0.5s ease-in-out;
        }

        .form-container h1 {
            margin-bottom: 20px;
            color: #333;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #555;
            text-align: left;
        }

        input[type="text"],
        input[type="number"],
        select {
            width: calc(100% - 20px);
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 14px;
            box-sizing: border-box;
        }

        button {
            border: 4px solid #BF0000;
            background: #FFF;
            color: #BF0000;
            font-size: 1.2em;
            line-height: 30px;
            padding: 12px 0; /* Reduced padding by 20% */
            text-decoration: none;
            text-shadow: none;
            border-radius: 25px;
            box-shadow: none;
            transition: 0.25s;
            display: block;
            width: 60%;
            max-width: 200px;
            margin: 16px auto 8px; /* Reduced bottom margin */
            font-weight: bold;
            cursor: pointer;
        }

        button:hover {
            background-color: #f0f0f0;
            transform: translateY(-3px);
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .image-container {
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="background">
        <div class="form-container">
            <div class="image-container">
                <img src="http://localhost:5500/js/client/image/safety_log.jpg" alt="Safety Log Image" width="100%">
            </div>
            <h1>避難所情報を登録</h1>
            <form id="shelterForm">
                <label for="shelterName">避難所名</label>
                <input type="text" id="shelterName" name="shelterName" required>

                <label for="prefecture">県</label>
                <select id="prefecture" name="prefecture" required>
                    <option value="">選択してください</option>
                    <option value="Hokkaido">北海道</option>
                    <option value="Aomori">青森県</option>
                    <option value="Iwate">岩手県</option>
                    <option value="Miyagi">宮城県</option>
                    <option value="Akita">秋田県</option>
                    <option value="Yamagata">山形県</option>
                    <option value="Fukushima">福島県</option>
                    <option value="Ibaraki">茨城県</option>
                    <option value="Tochigi">栃木県</option>
                    <option value="Gunma">群馬県</option>
                    <option value="Saitama">埼玉県</option>
                    <option value="Chiba">千葉県</option>
                    <option value="Tokyo">東京都</option>
                    <option value="Kanagawa">神奈川県</option>
                    <option value="Niigata">新潟県</option>
                    <option value="Toyama">富山県</option>
                    <option value="Ishikawa">石川県</option>
                    <option value="Fukui">福井県</option>
                    <option value="Yamanashi">山梨県</option>
                    <option value="Nagano">長野県</option>
                    <option value="Gifu">岐阜県</option>
                    <option value="Shizuoka">静岡県</option>
                    <option value="Aichi">愛知県</option>
                    <option value="Mie">三重県</option>
                    <option value="Shiga">滋賀県</option>
                    <option value="Kyoto">京都府</option>
                    <option value="Osaka">大阪府</option>
                    <option value="Hyogo">兵庫県</option>
                    <option value="Nara">奈良県</option>
                    <option value="Wakayama">和歌山県</option>
                    <option value="Tottori">鳥取県</option>
                    <option value="Shimane">島根県</option>
                    <option value="Okayama">岡山県</option>
                    <option value="Hiroshima">広島県</option>
                    <option value="Yamaguchi">山口県</option>
                    <option value="Tokushima">徳島県</option>
                    <option value="Kagawa">香川県</option>
                    <option value="Ehime">愛媛県</option>
                    <option value="Kochi">高知県</option>
                    <option value="Fukuoka">福岡県</option>
                    <option value="Saga">佐賀県</option>
                    <option value="Nagasaki">長崎県</option>
                    <option value="Kumamoto">熊本県</option>
                    <option value="Oita">大分県</option>
                    <option value="Miyazaki">宮崎県</option>
                    <option value="Kagoshima">鹿児島県</option>
                    <option value="Okinawa">沖縄県</option>                    
                </select>

                <label for="latitude">緯度</label>
                <input type="number" id="latitude" name="latitude" step="0.000001" required>

                <label for="longitude">経度</label>
                <input type="number" id="longitude" name="longitude" step="0.000001" required>

                <label for="capacity">収容人数</label>
                <input type="number" id="capacity" name="capacity" required>

                <label for="food">食料（食）</label>
                <input type="number" id="food" name="food" required>

                <label for="water">水（L）</label>
                <input type="number" id="water" name="water" required>

                <label for="medicine1">薬１（錠）</label>
                <input type="number" id="medicine1" name="medicine1" required>

                <label for="medicine2">薬２（錠）</label>
                <input type="number" id="medicine2" name="medicine2" required>

                <label for="medicine3">薬３（錠）</label>
                <input type="number" id="medicine3" name="medicine3" required>

                <button type="submit">登録</button>
            </form>
        </div>
    </div>

    <script>
        document.getElementById('shelterForm').addEventListener('submit', function(event) {

            event.preventDefault();

            const requiredFields = document.querySelectorAll('#shelterForm [required]');
            let allFilled = true;

            requiredFields.forEach(function(field) {
                if (!field.value) {
                    allFilled = false;
                    field.style.borderColor = 'red';
                } else {
                    field.style.borderColor = '#ccc';
                }
            });

            if (!allFilled) {
                alert('すべての必須フィールドを入力してください。');
                return;
            }

            const shelterName = document.getElementById('shelterName').value;
            const prefecture = document.getElementById('prefecture').value;
            const latitude = document.getElementById('latitude').value;
            const longitude = document.getElementById('longitude').value;
            const capacity = document.getElementById('capacity').value;
            const food = document.getElementById('food').value;
            const water = document.getElementById('water').value;
            const medicine1 = document.getElementById('medicine1').value;
            const medicine2 = document.getElementById('medicine2').value;
            const medicine3 = document.getElementById('medicine3').value;

            fetch('/Registration', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    shelterName: shelterName,
                    prefecture: prefecture,
                    location: {
                        latitude: latitude,
                        longitude: longitude
                    },
                    capacity: capacity,
                    food: food,
                    water: water,
                    medicines: {
                        medicine1: medicine1,
                        medicine2: medicine2,
                        medicine3: medicine3
                    }
                })
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error('登録に失敗しました');
                }
            })
            .then(data => {
                console.log('登録が完了しました');
                window.location.href = '/Map';
                console.log(data);
            })
            .catch(error => {
                console.log('エラーが発生しました: ' + error.message);
            });
        });
    </script>
</body>
</html>
